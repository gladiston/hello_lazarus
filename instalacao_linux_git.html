<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instalação no Windows: Usando GIT</title>
</head>
<body>
    <h3>Instalação no Windows: Usando GIT</h3>
    <hr>
    <p>Embora hajam pacotes binários já prontos para Linux dentro do repositório de sua distro, 
        recomendo que faça uma instalação por fora com o fpcupdeluge ou compilando o código fonte do Lazarus
        porque desse modo sua instalação será homeuser, além disso, a versão binária compilada por você
        mesmo será específica para o seu hardware e portanto mais veloz que o instalado pela distro. 
        Usaremos o git, que é mais econômico porque usaremos o FreePascal pré-instalado. 
        Se estiver interessado, siga as instruções abaixo, mas apenas se domina razoavelmente o 
        linux porque eventualmente é preciso diagnosticar dependencias.
    <ol>
        <li>Instale o compilador FreePascal a partir do repositório oficial, se estiver usando Fedora 
            (Redhat e derivados):
            <pre>sudo dnf install fpc.x86_64 fpc-src.noarch </pre>
        </li>
        <li>O comando anterior instalou tanto os binários quanto o código fonte, mas se precisar 
            saber onde os fontes estão instalados, execute o comando:
            <pre>rpm -ql fpc-src.noarch</pre>
            E notará que foram instalados em /usr/share/fpcsrc, anote este caminho porque precisaremos dele mais tarde.
        </li>
        <li>Apague a pasta <b>~/.lazarus</b> se existir.</li>
        <li>Vá até o terminal e indique onde deseja o lazarus instalado, por exemplo, 
            se desejar diretamente na raiz de sua $HOME então:
<pre>cd ~
mkdir lazarus
cd lazarus
git clone https://gitlab.com/freepascal.org/lazarus/lazarus.git</pre>
        </li>
        <li>Foi criada uma pasta ‘lazarus’ ficando assim ~/lazarus/lazarus, então vamos renomear esta última
            para representar a versão que desejamos, por exemplo, a 2.2.
<pre>
mv lazarus lazarus22
cd lazarus22/</pre>
        </li> 
        <li>Vamos criar uma pasta ‘configs’ que servirá para armazenar a configuração do Lazarus:
            <pre>mkdir configs</pre>            
        </li>       
        <li>Execute ainda::
            <pre>git branch --all</pre>
            E será listado:
<pre>
(...)
remotes/origin/fixes_2_0
<b>remotes/origin/fixes_2_2</b>
(...)</pre>            
        </li> 
        <li>E então escolhemos uma versão específica, no exemplo acima escolheremos <b>fixes_2_2</b>
            que incluirá a 2.2 mais os fixes dessa versão. Mas se desejar uma outra versão que esteja 
            saindo do forno,também pode, mas lembre de renomear o diretório para algo mais conveniente. 
            Para prosseguir com o nosso exemplo:
            <pre>git switch fixes_2_2</pre>
        </li> 
        <li>Finalmente vamos compilar, ainda no terminal execute:
<pre>make clean 
make bigide</pre> 
        (demora um pouco, mas vai compilar tudo)     
       </li> 
       <li>Anote onde o Lazarus foi instalado, a saber, <b>~/lazarus/lazarus22</b> e depois 
        crie um link simbolico para ele:
        <pre>sudo ln -s ~/lazarus/lazarus22/lazarus /usr/bin/lazarus22</pre>
        Usamos o nome lazarus22 apenas para indicar que se trata do Lazarus 2.2, 
        poderiamos ter usado apenas <b>lazarus</b> se mantivessemos apenas uma versão.
       </li>
       <li>Crie um atalho para ele em sua área de trabalho:
        <pre>gedit ~/.local/share/applications/lazarus.desktop</pre>
        <p>e então cole as instruções abaixo:</p>
<textarea disabled rows=12 cols=80>
[Desktop Entry]
Version=1.0
Type=Application
Terminal=false
Name=Lazarus 2.2
Exec=lazarus22 --pcp=~/lazarus/lazarus22/configs
Comment=Lazarus 2.2+fixes
Icon=~/lazarus/lazarus22/images/icons/lazarus.ico 
Category=Application;IDE;Development;GUIDesigner;Programming;
Categories=Application;IDE;Development;GUIDesigner;Programming;
Keywords=editor;Pascal;IDE;FreePascal;fpc;Design;Designer;            
</textarea>
        <p>Salve o arquivo, a partir de agora, o Lazarus 2.2 aparecerá no menu de seu sistema
            se procurar pelo nome.</p>

       </li>
       <li>Execute o lazarus pela primeira vez dessa forma:
           <pre>lazarus22 --pcp=~/lazarus/lazarus22/lazarus/configs</pre>
        <p>Isso garantirá que as configurações que fizer dentro da IDE serão gravadas neste local 
            indicado e poderão mais tarde serem salvas noutro local para a posteridade.</p>
       </li>
    </ol>
    <p>Eventualmente você poderá querer baixar novas versões ou atualizações,
        trata-se dum repositório git então não haverá problemas, sempre que precisar recorra aos comandos:</p>
<pre>git switch <b>main</b>
git pull  </pre>
    <p>Onde <b>main</b> é o branch atual, mas você pode trocá-lo se preferir e então repita 
     os procedimentos anteriores que culminarão no ‘make big ide' mencionado nos passos anteriores.</p>
    <p>Geralmente, as correções do Lazarus estarão listadas com o nome de branchs como prefixo‘fixes’,
        então será fácil identificar atualizações.</p>
    <p><b>TODO</b>: Adicionar opções para crosscompiling, da forma como esta acima, os projetos serão 
     compilados apenas para o ambiente do host, isto é, se estiver num amd64 apenas compilará para 64bits.</p>        
</body>
</html>