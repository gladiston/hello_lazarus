<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instalação no Windows: Usando GIT</title>
</head>
<body>
    <h1>Instalação no Windows: Usando GIT</h1>
    <hr
    <p>A maioria dos que estiverem lendo essas instruções irão preferir usar o <strong>Instalador do Lazarus</strong> 
        ou o <strong>fpcupdeluge</strong>. Porém há uma terceira via que funciona para Windows e Linux,
        a instalação diretamente do código fonte do Lazarus, parece complicado, mas não é se você já 
        compilou programas via GIT antes. Há algumas vantagens nisso, a versão binária compilada por você
        mesmo será específica para o seu hardware e portanto mais veloz que a versão do instalador, 
        assim como no fpcupdeluge. Porém essa terceira via é mais econômica e rápida do que usando 
        o fpcupdelge porque usaremos o FreePascal(FPC daqui em diante) pré-instalado.</p>
     <p>Como o Lazarus está num repositório GIT, temos outra vantagem>:atualização de versão. <br>
         Siga as instruções abaixo, embora sejam para o Windows, os princípios 
           são os mesmos para Linux.</p>
    <ol>
    <li>
        <p>Instale o FPC a partir do instalador oficial:<br>
        <a href="https://www.freepascal.org/download.html">https://www.freepascal.org/download.html</a></p>
        <p>Escolha a versão apropriada para seu sistema, a mais compativel será “Intel x86/i386->Windows 32-bit”, 
            mas também poderá usar a versão 64bits indicada abaixo:<br>
            <img src="assets/instalacao_windows_git1.png" alt="Download do FPC" width="auto" height="auto">
        <p>A instalação é uma sequência de <strong>Next->Next->Finish</strong> e não carece de maiores detalhoes.
            Para fins didáticos, vamos supor daqui em diante que o tenhamos instalado em <strong>C:\FPC\3.2.2.</strong></p>    
    </li>    
    <li><p>Acrescente à variavel de ambiente chamada <strong>PATH</strong> o caminho de instalação do FPC:</p>
        <p><img src="assets/instalacao_windows_git3.png" alt="FPC no PATH do ambiente" width="auto" height="auto"></p>
    </li>    
    <li>
        <p>Precisará baixar o código fonte do FPC, você poderá obtê-lo em:<br>
        <a href="https://www.freepascal.org/down/source/sources.html">https://www.freepascal.org/down/source/sources.html</a></p>
        <p>O código fonte normalmente está compactado e com o sufixo “source” no nome, como pode ver na imagem a seguir:<br>
            <img src="assets/instalacao_windows_git2.png" alt="Download do código fonte do FPC" width="auto" height="auto">
        </p>    
        <p>Então baixe-o, depois descompacte-o na pasta onde o FPC foi instalado, em nosso exemplo: 
            <strong>c:\FPC\3.2.2</strong> e então uma subpasta com o código fonte será criada e depois
            ficará assim: <strong>C:\FPC\3.2.2\subpasta</strong>, renomeie o nome da <strong>subpasta</strong> 
            para <strong>sources</strong> para ser mais informativo e então anote este caminho -
            <strong>C:\FPC\3.2.2\sources</strong>. Iremos precisar lembrar deste path mais adiante.
        </p>
    </li>
    <li>Apague a pasta <strong>%USERPROFILE%\AppData\Local\Lazarus</strong> se existir.</li>

    <li><p>Abra o cmd.exe ou o terminal.<br>
        Se tiver o Delphi instalado, recomendo que execute:</p>
        <pre>set path=C:\FPC\3.2.2\bin\i386-win32;%PATH%</pre>
        <p>Este comando servirá para que os utilitários do FPC tenham preferencia aos utilitários do
        Delphi que possuem o mesmo nome.</p>
    </li>
    <li><p>Vamos criar a pasta que receberá os arquivos do Lazarus:</p>
<pre>mkdir c:\lazarus
cd c:\Lazarus
git clone https://gitlab.com/freepascal.org/lazarus/lazarus.git    
</pre>
    <p>O comando acima criou a pasta <strong>c:\lazarus\lazarus</strong>, este é um nome muito estranhgo para 
trabalharmos então vamos renomear a subpasta <strong>lazarus</strong> para um nome mais 
refinado como <strong>lazarus22</strong> ficando no final<strong>c:\lazarus\lazarus22</strong>:</p>
<pre>ren lazarus lazarus22
cd lazarus22
</pre>
    </li>
    <li>Vamos ainda criar uma subspasta <strong>c:\lazarus\lazarus22/configs</strong>
    <pre>mkdir configs</pre>
    </li>
    <li>Estando ainda na pasta <strong>c:\lazarus\lazarus22</strong>, executamos:
        <pre>git branch --all</pre>
        <p>Então será listado todos os branchs existentes no repositório oficial:</p>
<textarea rows=5 cols=80>
(...)
remotes/origin/fixes_2_0
remotes/origin/fixes_2_2
(...)    
</textarea>
<p>E então escolha um branch das que foram listadas, escolha a <strong>fixes_2_2</strong> que
    incluirá a 2.2.x mais os fixes, isto é, as correções  da série 2.2. Mas se desejar 
    uma versão que já está saindo do forno, volte ao passo anterior  e renomeie o diretório
    de <strong>c:\lazarus\lazarus22</strong> para outro nome  mais conveniente com a versão escolhida
    e repita os passos anteriores novamente. 
    Para prosseguir com o nosso exemplo usando o <strong>fixes_2_2</strong>:</p>
    <pre>git switch  fixes_2_2</pre>
</li> 
    <li><p>Vamos compilar, ainda no cmd.exe execute:</p>
<pre>make clean 
make bigide
</pre>
    <p>Vai demorar um pouco, relaxe e vá tomar com café enquanto isso.</p>
    </li>   
    <li><p>A compilação gerará <strong>c:\lazarus\lazarus22\lazarus.exe</strong>, crie um atalho para ele 
        em sua área de trabalho, mas faça-o com os seguintes parâmetros:</p>
        <pre>C:\lazarus\lazarus22\lazarus.exe --pcp=<strong>C:\lazarus\lazarus22\configs</strong></pre>        
        Onde <strong>C:\lazarus\lazarus22\configs</strong> é a pasta que o lazarus armazenará suas configurações. 
        Mais tarde se decidirmos ter mais uma versão do Lazarus, a configuração de um não influenciará o outro.</p>
        <p><strong>ALERTA:</strong> Esteja atento a nunca usar a pasta de configuração para versões diferentes de Lazarus.
        </p>
    </li>
    <li>Execute o lazarus pela primeira vez, mas faça isso por meio do atalho recém criado com o
         parâmetro<strong>c:\lazarus\lazarus22</strong>.</li>
    <li><p>Quando a IDE iniciar-se, geralmente a primeira tela será uma busca automática pelo código fonte do FPC.<br> 
        No ambiente Windows é raro encontrar a localização dos fontes sozinho então devemos clicar em “Parar” e a  
        procura será interrompida e daí então indicar o local onde o código fonte do FPC foi descompactado, 
        a saber <strong>C:\FPC\3.2.2\sources:</strong></p>
        <img src="assets/instalacao_windows_git4.png" alt="Download do código fonte do FPC" width="auto" height="auto">
        <p>E então clicar em Iniciar IDE. </p>
    </li>     
    </ol>
    <p>As instruções acima foram inspiradas na página:<br>
    <a href="https://wiki.lazarus.freepascal.org/Getting_Lazarus">https://wiki.lazarus.freepascal.org/Getting_Lazarus</a></p>
    <p>Se algo sair diferente do esperado, acesse o link acima, talvez ele esclareça o que deu de errado.</p>

</body>
</html>